#!/usr/bin/env bash

VIDEO=$(fd -e mkv --max-depth 1 --type f . "$HOME/Videos" --exec stat -c '%Y %n' {} \; |
  sort -rn | head -1 | cut -d' ' -f2-)

if [ -z "$VIDEO" ]; then
  echo "No video files found in $HOME/Videos"
  exit 1
fi

if ! pgrep firefox >/dev/null; then
  echo "Firefox isn't running"
  exit 1
fi

echo "Opening most recent video: $VIDEO"

firefox --private-window "$VIDEO"

echo ""
read -p "Do you want to delete this video? (y/n): " -n 1 -r
echo ""

if [[ $REPLY =~ ^[Yy]$ ]]; then
  rm "$VIDEO"
  echo "Video deleted: $VIDEO"
else
  echo "Video kept: $VIDEO"
fi
